!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("fingerprintjs2"),require("ua-parser-js")):"function"==typeof define&&define.amd?define(["exports","fingerprintjs2","ua-parser-js"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).StatisticsPlugin={},e.fingerprintjs2,e.uaParserJs)}(this,(function(e,t,n){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=r(t),i=r(n),s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function a(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function d(e,t){return e(t={exports:{}},t.exports),t.exports}var l=d((function(e,t){t.__esModule=!0,t.default=function(e,t,n){var r=new XMLHttpRequest;r.onreadystatechange=function(){XMLHttpRequest.DONE===this.readyState&&t(200!==this.status&&new Error("StatisticsPlugin: server respnse status is "+this.status),this.responseText,this)},r.open(n.method?n.method.toUpperCase():"GET",e,!0),"boolean"==typeof n.withCredentials&&(r.withCredentials=n.withCredentials),n.headers&&(Object.keys(n.headers).forEach((function(e){void 0!==n.headers[e]&&null!==n.headers[e]&&r.setRequestHeader(e,n.headers[e])})),n.headers["Content-Type"]||r.setRequestHeader("Content-Type","application/x-www-form-urlencoded")),n.post?r.send(n.post):r.send()}}));a(l);var u=d((function(e,t){t.__esModule=!0,t.parseURLSearch=void 0,t.parseURLSearch=function(e){void 0===e&&(e=window.location.search);var t={};e.length&&("?"===e[0]&&(e=e.slice(1)),e.split("&").forEach((function(e){var n=e.split("=");t[n[0]]=decodeURIComponent(n[1])})));return t}}));a(u),u.parseURLSearch;var p=a(d((function(e,t){var n=s&&s.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};t.__esModule=!0;var r=window.localStorage.getItem("TZ_USER_MURMUR");r||o.default.default.get(null,(function(e){r=o.default.default.x64hash128(e.map((function(e){return e.value})).join(""),31),window.localStorage.setItem("TZ_USER_MURMUR",r)}));var a=i.default.default(),d=a.browser,p=a.os,f=a.device,c=window.navigator,h=c.connection||c.mozConnection||c.webkitConnection,v=function(){function e(e){this.options=Object.assign({},e),this.referrer=window.document.referrer,this.params={device_id:r,device_width:window.screen.width,device_height:window.screen.height,device_makers:f.vendor,os_name:p.name,os_version:p.version,browser:d.name,browser_version:d.version},(null==h?void 0:h.type)&&(this.params.is_wifi="wifi"===h.type.toLocaleLowerCase())}return e.prototype.registerUserToken=function(e){this.options.token=e},e.prototype.resolveChannelId=function(e){var t=u.parseURLSearch().channelId,n=e.targetUrl;if(!t&&n){var r=n.split("?")[1];r&&(t=u.parseURLSearch(r).channelId)}return t},e.prototype.resolveReportData=function(e,t){var r=JSON.parse(JSON.stringify(t)),o=this.resolveChannelId(r);r.targetUrl&&delete r.targetUrl;var i=n(n(n(n({},this.params),{begin_time:Date.now(),current_url:window.location.href,referrer_url:this.referrer}),r),{event_id:e});return o&&(i.channel=o),i},e.prototype.report=function(e,t){void 0===t&&(t={});var n=this.resolveReportData(e,t);try{l.default(this.options.url,(function(e){e&&console.log(e)}),{post:JSON.stringify(n),method:"post",headers:{"Content-Type":"application/json;charset=UTF-8",token:this.options.token,terminalType:this.options.terminal}})}catch(e){console.error(e)}},e}();t.default=v}))),f=d((function(e,t){t.__esModule=!0}));a(f),e.__moduleExports=f,e.default=p,Object.defineProperty(e,"__esModule",{value:!0})}));
